# values.yaml para OpenShift sin permisos de admin

# NO crear ServiceAccount personalizado, usar el default
serviceAccount:
  create: false
  # Usará el ServiceAccount "default" del namespace

# Configuración de autenticación
auth:
  enablePostgresUser: true
  postgresPassword: "openshift"  # CAMBIA ESTO
  username: "openshift"
  password: "openshift"  # CAMBIA ESTO
  database: "proj-openshift"

# Configuración de arquitectura
architecture: standalone

# Configuración del primary
primary:
  # Persistencia
  persistence:
    enabled: true
    storageClass: ""
    size: 10Gi
    accessModes:
      - ReadWriteOnce
  
  # Recursos
  resources:
    requests:
      memory: "256Mi"
      cpu: "250m"
    limits:
      memory: "1Gi"
      cpu: "1000m"
  
  # CRÍTICO: Deshabilitar security contexts para que OpenShift los asigne
  containerSecurityContext:
    enabled: false
  
  podSecurityContext:
    enabled: false
  
  # Servicio
  service:
    type: ClusterIP
    ports:
      postgresql: 5432
  
  # Configuración adicional para OpenShift
  podAnnotations:
    openshift.io/scc: restricted-v2

# CRÍTICO: Deshabilitar volumePermissions init container
# Este init container es el que causa el problema de SCC
volumePermissions:
  enabled: false

# Deshabilitar shmVolume (puede causar problemas en restricted)
shmVolume:
  enabled: false

# Configuración de PostgreSQL
postgresql:
  maxConnections: "100"
  sharedBuffers: "128MB"

# Métricas
metrics:
  enabled: false

# Asegurarse de que no haya init containers problemáticos
diagnosticMode:
  enabled: false